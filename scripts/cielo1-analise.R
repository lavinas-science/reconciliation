# parsing
ro_init <- c(1, 2, 12, 19, 21, 22, 24, 26, 32, 38, 44, 45, 58, 59, 72, 73, 86, 87, 100, 104, 109, 123, 125, 131, 132, 133, 139, 140, 146, 148, 161, 162, 171, 172, 185, 188, 210, 214, 219, 223, 225, 233, 236, 246, 247, 248, 250)
ro_end <- c(1, 11, 18, 20, 21, 23, 25, 31, 37, 43, 44, 57, 58, 71, 72, 85, 86, 99, 103, 108, 122, 124, 130, 131, 132, 138, 139, 145, 147, 160, 161, 170, 171, 184, 187, 209, 213, 218, 222, 224, 232, 235, 245, 246, 247, 249, 250)
ro_title <- c('tipo', 'est_sub', 'ro', 'parcela', 'filler', 'plano', 'tipo_trans', 'dt_apresenta', 'dt_pagto', 'dt_venc_original', 'sin_bruto', 'vl_bruto', 'sin_taxa', 'vl_taxa', 
              'si_rejeit', 'vl_rejeit', 'sinal_liquido', 'vl_liquido', 'banco', 'agencia', 'conta', 'status_pagto', 'qtde_cv', 'receba_rapido', 'taxa_minima', 'qtde_cv_rejeit', 
              'rev_aceler', 'dt_captura', 'origem_ajuste', 'vl_complement', 'antecipa', 'nr_antecipa', 'sin_bruto_antecip', 'vl_bruto_antecip', 'bandeira', 'ro_unico', 'tx_adm_%', 'tar_adm',
              'tx_receba_rapido', 'meio_captura', 'nr_terminal', 'codigo_produto', 'matriz_pagto', 'reenvio_pagto', 'conceito_aplicado', 'grupo_cartoes', 'ind_saldo_aberto')
cv_init <- c(1, 2, 12, 19, 38, 46, 47, 60, 62, 64, 67, 73, 93, 99, 112, 114, 127, 140, 149, 151, 153, 161, 163, 183, 189, 218, 219, 221, 236)
cv_end <- cv_init - 1
cv_end <- cv_end[2:length(cv_end)]
cv_end <- c(cv_end, 250)
cv_title <- c('tipo', 'est_sub', 'ro', 'nr_cart', 'dt_venda_ajuste', 'sin_compra_parc', 'vl_compra_parc', 'parcel', 'tot_parcel', 'motivo_rejei', 'cod_autoriz', 'tid', 'nsu', 'vl_compl', 
              'dig_cartao', 'vl_total_venda', 'vl_prox_parcela', 'nr_nota_fiscal', 'tipo_cart', 'grupo_cartoes', 'nr_logico_term', 'id_taxa_embarque', 'cod_pedido', 'hora_trans',
              'nr_unico_transacao', 'cielo_promo', 'modo_entrada_cartao', 'codigo_venda', 'codigo_interno_ajuste')


# input
ag_ro_txt <- "111176316964210524     03210624210628210628-0000000099728+0000000000947+0000000000000-00000000987810033003190000015000007200000001NN000000 210624170000000000000 000000000+00000000000000022114451201227340000001009500000000003100874740121117631696NN00 "
pg_ro_1_txt <- "11117631696421052401/1001210528210628210628+0000000023147-0000000000255+0000000000000+00000000228920033003190000150000072002000002NN000000 210528  0000000000000 000000000+00000000000000022114851201546690000001011000000000003100874740121117631696NN00 "
pg_ro_2_txt <- "111176316964210524     03210624210628210628-0000000019946+0000000000189+0000000000000-00000000197570033003190000150000072002000001NN000000 210624170000000000000 000000000+00000000000000022114451201227340000001009500000000003100874740121117631696NN00 "

ag_cv_txt <- "211176316964210524   516292******761320210524-00000000997280000   2366021117631696119HSISM4C32100800000000000001600000000000000000000000000000000000000110087474  TIA12246001150001   00000021144512012273400000010009001 81000000000000000240610420002361"
pg_cv_ro_1_1_txt <- "211176316964210524   516292******906020210528+00000000124450110   8823501117631696119HTCGVPC10014100000000000001600000000000000000000000000000000000000010087474  TIA12253971510001   16103021148512015466900000010001001 81000000000000000000000000000000"
pg_cv_ro_1_2_txt <- "211176316964210524   516292******977220210528+00000000107020110   2066821117631696119HTBSE1C10411700000000000001600000000000000000000000000000000000000010087474  TIA12239757940001   16073421148512015466900000010002001 81000000000000000000000000000000"
pg_cv_ro_2_1_txt <- "211176316964210524   516292******761320210524-00000000199460000   2366021117631696119HSISM4C32100800000000000001600000000000000000000000000000000000000110087474  TIA12246001150001   00000021144512012273400000010009001 81000000000000000240610420002361"

ro_ori_txt <- "11117631696421052401/0601210524210623000000+0000000281954-0000000002679+0000000000000+0000000279275003300319000001500000720000001212000000 210524  0000000000000 000000000+00000000000000022114451201227340000000009500000000003100874740121117631696N    "
cv_ori_txt <- "211176316964210524516292******761300020210524+00000000199480105   2366021117631696119HSISM4C10607100000000000001600000000997280000000019945000000000000110087474  TIA12246001150001   11355721144512012273400000000009000 81                              "



# Prepare ro
ag_ro <- substring(ag_ro_txt, ro_init, ro_end)
names(ag_ro) <- ro_title
pg_ro_1 <- substring(pg_ro_1_txt, ro_init, ro_end)
names(pg_ro_1) <- ro_title
pg_ro_2 <- substring(pg_ro_2_txt, ro_init, ro_end)
names(pg_ro_2) <- ro_title
ro_ori <- substring(ro_ori_txt, ro_init, ro_end)
names(ro_ori) <- ro_title
ro_dt <- data.frame(ro_ori, ag_ro, pg_ro_2)

ag_cv <- substring(ag_cv_txt, cv_init, cv_end)
names(ag_cv) <- cv_title
pg_cv_ro_1_1 <- substring(pg_cv_ro_1_1_txt, cv_init, cv_end)
names(pg_cv_ro_1_1) <- cv_title
pg_cv_ro_1_2 <- substring(pg_cv_ro_1_2_txt, cv_init, cv_end)
names(pg_cv_ro_1_2) <- cv_title
pg_cv_ro_2_1 <- substring(pg_cv_ro_2_1_txt, cv_init, cv_end)
names(pg_cv_ro_2_1) <- cv_title
cv_ori <- substring(cv_ori_txt, cv_init, cv_end)
names(cv_ori) <- cv_title

cv_dt <- data.frame(cv_ori, ag_cv, pg_cv_ro_2_1)


# see
ro_dt
cv_dt